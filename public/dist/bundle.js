!function(e){function t(a){if(n[a])return n[a].exports;var s=n[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=2)}([function(e,t,n){"use strict";function a(){var e=this;this.config={colors:["#000000","#ffffff","#5c3e28","#ff3b3b","#f7821c","#ffdc00","#2ee643","#007fee","#B10DC9","#F012BE"]},this.initialize=function(t){e.current={x:0,y:0,color:e.config.colors[0],size:25};var n=e.createDOM(),a=n.canvas,s=n.toolbar;e.element=t,e.element.appendChild(a),e.element.appendChild(s),e.socket=io(),e.canvas=document.querySelector(".whiteboard"),e.colors=document.querySelectorAll(".color"),e.lineWidthRange=document.querySelector(".line-width"),e.lineWidthDisplay=document.querySelector(".circle"),e.clearButton=document.querySelector("button#clear"),e.ctx=e.canvas.getContext("2d"),e.drawing=!1,["mousedown","mouseup","mouseout","mousemove"].forEach(function(t){return e.canvas.addEventListener(t,e.throttle(e.mouseEventHandler,0))}),["touchstart","touchmove","touchcancel","touchend","touchcancel"].forEach(function(t){return e.canvas.addEventListener(t,e.throttle(e.touchEventHandler,0))}),e.colors.forEach(function(t){t.style.backgroundColor=t.dataset.color,t.addEventListener("click",e.updateColor)}),e.lineWidthRange.addEventListener("input",e.updateLineWidth),e.clearButton.addEventListener("click",e.clearEventHandler),e.socket.on("drawing",e.onDrawingEvent),e.socket.on("history",e.onCanvasHistory),e.socket.on("clear",e.clearCanvas),window.addEventListener("resize",e.onResize),e.onResize()},this.createDOM=function(){var t=e.createElement("canvas",{classes:["whiteboard"]}),n=e.createElement("div",{classes:["toolbar"]}),a=e.createElement("div",{classes:["line-width-container"]}),s=e.createElement("input",{classes:["line-width"],attribs:[{name:"type",value:"range"},{name:"min",value:1},{name:"max",value:50},{name:"step",value:1},{name:"value",value:e.current.size}]}),r=e.createElement("div",{classes:["circle-container"]}),c=e.createElement("span",{classes:["circle"]});c.style.width=s.value+"px",c.style.height=s.value+"px",a.appendChild(s),r.appendChild(c),a.appendChild(r);var o=e.createElement("div",{classes:["colors"]});e.config.colors.forEach(function(t){var n=e.createElement("div",{classes:["color"],attribs:[{name:"data-color",value:t}]});o.appendChild(n)}),o.children[0].classList.add("active");var i=e.createElement("button",{id:"clear",text:"Clear"});return n.appendChild(i),n.appendChild(a),n.appendChild(o),{canvas:t,toolbar:n}},this.createElement=function(e,t){var n=document.createElement(e);return t.id&&(n.id=t.id),t.classes&&t.classes.forEach(function(e){return n.classList.add(e)}),t.attribs&&t.attribs.forEach(function(e){n.setAttribute(e.name,e.value)}),t.text&&(n.textContent=t.text),n},this.updateLineWidth=function(t){var n=t.target.value;e.lineWidthDisplay.style.width=n+"px",e.lineWidthDisplay.style.height=n+"px",e.current.size=n},this.clearCanvas=function(t){e.ctx.fillStyle="#fff",e.ctx.fillRect(0,0,e.canvas.width,e.canvas.height),t&&e.socket.emit("clear")},this.clearEventHandler=function(t){e.clearCanvas(!0)},this.onCanvasHistory=function(t){t.forEach(function(t){e.onDrawingEvent(t)})},this.updateColor=function(t){document.querySelector(".color.active").classList.remove("active"),t.target.classList.add("active"),e.current.color=t.target.dataset.color,e.lineWidthDisplay.style.backgroundColor=t.target.dataset.color},this.getMousePos=function(t){var n=e.canvas.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}},this.drawLine=function(t,n,a,s,r,c,o){if(e.ctx.beginPath(),e.ctx.lineCap="round",e.ctx.lineJoin="round",e.ctx.lineWidth=c,e.ctx.strokeStyle=r,e.ctx.moveTo(t,n),e.ctx.lineTo(a,s),e.ctx.stroke(),e.ctx.closePath(),o){var i=e.getCanvasDimensions(),l=i.w,u=i.h;e.socket.emit("drawing",{x0:t/l,y0:n/u,x1:a/l,y1:s/u,color:r,size:c})}},this.mouseEventHandler=function(t){var n=e.getMousePos(t);switch(t.type){case"mousedown":e.drawing=!0,e.current.x=n.x,e.current.y=n.y;break;case"mousemove":if(!e.drawing)return;e.drawLine(e.current.x,e.current.y,n.x,n.y,e.current.color,e.current.size,!0),e.current.x=n.x,e.current.y=n.y;break;default:if(!e.drawing)return;e.drawing=!1,e.drawLine(e.current.x,e.current.y,n.x,n.y,e.current.color,e.current.size,!0)}},this.getTouchPos=function(t){var n=e.canvas.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}},this.touchEventHandler=function(t){if(t.preventDefault(),1===t.targetTouches.length){var n=e.getTouchPos(t.targetTouches[0]);switch(t.type){case"touchstart":e.drawing=!0,e.current.x=n.x,e.current.y=n.y;break;case"touchmove":if(!e.drawing)return;e.drawLine(e.current.x,e.current.y,n.x,n.y,e.current.color,e.current.size,!0),e.current.x=n.x,e.current.y=n.y;break;default:if(!e.drawing)return;e.drawing=!1,e.drawLine(e.current.x,e.current.y,n.x,n.y,e.current.color,e.current.size,!0)}}},this.onDrawingEvent=function(t){var n=e.getCanvasDimensions(),a=n.w,s=n.h;e.drawLine(t.x0*a,t.y0*s,t.x1*a,t.y1*s,t.color,t.size)},this.onResize=function(){e.canvas.width=window.innerWidth,e.canvas.height=window.innerHeight,e.socket.emit("resize")},this.throttle=function(e,t){var n=(new Date).getTime();return function(){var a=(new Date).getTime();a-n>=t&&(n=a,e.apply(null,arguments))}},this.getCanvasDimensions=function(){return{w:e.canvas.width,h:e.canvas.height}}}function s(){var e=this;this.config={colors:["#e21400","#91580f","#f8a700","#f78b00","#58dc00","#287b00","#a8f07a","#4ae8c4","#3b88eb","#3824aa","#a700ff","#d300e7"]},this.initialize=function(t){e.element=t,e.element.appendChild(e.createDOM()),e.usernameInput=document.querySelector(".usernameInput"),e.messages=document.querySelector(".messages"),e.messageInput=document.querySelector(".messageInput"),e.loginPage=document.querySelector(".login.page"),e.chatPage=document.querySelector(".chat.page"),e.chatToggle=document.querySelector("#chatToggle"),e.chatToggle.addEventListener("click",e.onChatToggle),e.participants=document.querySelector("#numUsers"),e.usernameInput.value=localStorage.getItem("username")?localStorage.getItem("username"):"",e.currentInput=e.usernameInput,e.currentInput.focus(),e.unreadMessages=0,e.socket=io(),e.addSocketListeners(),window.addEventListener("keydown",function(t){e.element.classList.contains("closed")||(e.username&&27===t.keyCode&&e.onChatToggle(),t.ctrlKey||t.metaKey||t.altKey||e.currentInput.focus(),13===t.keyCode&&(e.username?e.sendMessage():e.setUsername()))})},this.onChatToggle=function(t){e.flash(e.chatToggle,"green"),e.element.classList.toggle("closed"),e.element.classList.contains("closed")?e.chatToggle.textContent="Open Chat ("+e.unreadMessages+")":(e.chatToggle.textContent="Close Chat",e.unreadMessages=0)},this.createDOM=function(){var t=e.createElement("ul",{classes:["pages"]}),n=e.createElement("li",{classes:["chat","page"]}),a=e.createElement("div",{classes:["chatArea"]}),s=e.createElement("ul",{classes:["messages"]}),r=e.createElement("input",{classes:["messageInput"]}),c=e.createElement("li",{classes:["login","page"]}),o=e.createElement("div",{classes:["form"]}),i=e.createElement("h3",{classes:["title"],text:"Enter Your Username"}),l=e.createElement("input",{classes:["usernameInput"],attribs:[{name:"type",value:"text"},{name:"maxLength",value:"14"}]});return a.appendChild(s),n.appendChild(a),n.appendChild(r),t.appendChild(n),o.appendChild(i),o.appendChild(l),c.appendChild(o),t.appendChild(c),t},this.createElement=function(e,t){var n=document.createElement(e);return t.classes&&t.classes.forEach(function(e){return n.classList.add(e)}),t.attribs&&t.attribs.forEach(function(e){n.setAttribute(e.name,e.value)}),t.text&&(n.textContent=t.text),n},this.log=function(t,n){var a=document.createElement("li");a.classList.add("log"),a.textContent=t,e.addMessageElement(a,n)},this.setUsername=function(){e.username=e.usernameInput.value.trim(),localStorage.setItem("username",e.username),e.chatToggle=document.querySelector("#chatToggle"),e.chatToggle.disabled=!1,e.flash(e.chatToggle,"green"),e.chatToggle.textContent="Open Chat (0)",e.element.classList.add("closed"),e.loginPage.style.display="none",e.chatPage.style.display="block",e.currentInput=e.messageInput,e.socket.emit("add user",e.username)},this.sendMessage=function(){var t=e.messageInput.value.trim();e.messageInput.value="",e.addChatMessage({username:e.username,message:t}),e.socket.emit("new message",t)},this.addChatMessage=function(t){var n=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],document.createElement("span"));n.classList.add("username"),n.style.color=e.getUsernameColor(t.username),n.textContent=t.username;var a=document.createElement("span");a.classList.add("messageBody"),a.textContent=t.message;var s=document.createElement("li");s.classList.add("message"),s.dataset.username=t.username,s.appendChild(n),s.appendChild(a),e.addMessageElement(s,{})},this.addMessageElement=function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.messages.appendChild(t),e.messages.scrollTop=e.messages.scrollHeight},this.flash=function(e,t){e.classList.add("flash",t),setTimeout(function(){e.classList.remove("flash",t)},1e3)},this.getUsernameColor=function(t){for(var n=7,a=0;a<t.length;a++)n=t.charCodeAt(a)+(n<<5)-n;var s=Math.abs(n%e.config.colors.length);return e.config.colors[s]},this.updateUnreadMessages=function(){e.element.classList.contains("closed")&&(e.unreadMessages++,e.chatToggle.textContent="Open Chat ("+e.unreadMessages+")",e.flash(e.chatToggle,"blue"))},this.addSocketListeners=function(){e.socket.on("new message",function(t){e.addChatMessage(t),e.updateUnreadMessages()}),e.socket.on("chatHistory",function(t){t.forEach(function(t){console.log(t),e.addChatMessage(t)})}),e.socket.on("user joined",function(t){e.log(t.username+" joined"),e.updateUserNum(t)}),e.socket.on("login",function(t){e.updateUserNum(t),e.socket.emit("chatHistory")}),e.socket.on("user left",function(t){e.username&&e.log(t.username+" left"),e.updateUserNum(t)}),e.socket.on("disconnect",function(){return e.log("You have been disconnected.")})},this.updateUserNum=function(t){e.participants.textContent=t.numUsers}}var r=document.querySelector(".draw-container");(new a).initialize(r);var c=document.querySelector(".chat-container");(new s).initialize(c)},function(e,t){},function(e,t,n){"use strict";n(1),n(0)}]);